---
import { getLocalizedPath, getTagPath } from '@/i18n/path'
import { ui } from '@/i18n/ui'

interface Props {
  tags: string[]
  currentTag?: string
  lang: string
  tagCounts?: Map<string, number>
  showAllPosts?: boolean
  allPostsCount?: number
}

const { tags, currentTag = '', lang, tagCounts, showAllPosts = false, allPostsCount } = Astro.props
const allPostsText = ui[lang as keyof typeof ui]?.allPosts || 'All Posts'
---

<div class="no-heti flex flex-wrap gap-x-3 gap-y-3.2">
  {showAllPosts && (
    <a
      href={getLocalizedPath('tags', lang)}
      class:list={[
        'inline-block rounded-full border px-3.2 py-0.7 transition-colors ease-out',
        currentTag === ''
          ? 'c-primary font-medium border-primary bg-primary/3'
          : 'c-secondary border-secondary/30 hover:(c-primary border-primary/50)',
      ]}
    >
      {allPostsText}
      {allPostsCount !== undefined && (
        <span class="ml-1.5 text-0.85em opacity-80">
          {allPostsCount}
        </span>
      )}
    </a>
  )}

  {tags.map((tag) => {
    const count = tagCounts?.get(tag) || 0
    const isActive = currentTag === tag
    return (
      <a
        href={getTagPath(tag, lang)}
        class:list={[
          'inline-block rounded-full border px-3.2 py-0.7 transition-colors ease-out',
          isActive
            ? 'c-primary font-medium border-primary bg-primary/3'
            : 'c-secondary border-secondary/30 hover:(c-primary border-primary/50)',
        ]}
      >
        {tag}
        {count > 0 && (
          <span class="ml-1.5 text-0.85em opacity-80">
            {count}
          </span>
        )}
      </a>
    )
  })}
</div>
